<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="'UTF'-8">
    <title>Alt Composer</title>
    <link rel="icon" href="images/icon.png">

    <meta property="og:title" content="Alt Composer"/>
    <meta property="og:type" content="website"/>
    <meta property="og:description"
          content="Built For Building Image Descriptions"/>
    <meta property="og:image" content="images/preview.png">
    <meta property="og:image:alt" content="Alt-Text.org, white on a library green">

    <link rel="stylesheet" href="style/main.css">
    <link rel="stylesheet" href="style/results.css">
    <link rel="stylesheet" href="style/dropdowns.css">

    <script src="src/i18n-data.js"></script>
    <script src="https://unpkg.com/canvas-txt"></script>
    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js'></script>
    <script>
        const isoPageLang = window.navigator.language || DEFAULT_PAGE_LANG
        window.i18n = i18nText[isoPageLang] || i18nText[DEFAULT_PAGE_LANG]
    </script>
    <script type="module">
        const isoExtractionLang = window.navigator.language || DEFAULT_EXTRACTION_LANG_ISO
        const initialExtractionLang = iso639_2ToTesseract[isoExtractionLang] || iso639_2ToTesseract[DEFAULT_EXTRACTION_LANG_ISO]

        const worker = await Tesseract.createWorker();
        await worker.loadLanguage(initialExtractionLang);
        await worker.initialize(initialExtractionLang);

        window.tesseractWorker = worker
    </script>

    <script src="lib/fabric.min.js" defer></script>
    <script src="lib/flexsearch.min.js" defer></script>
    <script src="lib/findBoundaries.js" defer></script>
    <script src="lib/unicode-break.js" defer></script>
    <script src="lib/gen/WordBreakProperty.js" defer></script>

    <script src="src/ocr-crop.js" defer></script>
    <script src="src/image-gen.js" defer></script>
    <script src="src/results.js" defer></script>
    <script src="src/i18n.js" defer></script>

</head>
<body>
    <div id="overlay" onclick="closeDropdown()"></div>
    <div id="main">
        <div id="left-col">
            <div id="controls">
                <div id="left-ctl">
                    <div class="dropdown" aria-label="Page language select">
                        <button onclick="openDropdown('page-lang-dropdown', 'page-lang-text')"
                                class="drop-btn">
                            <img src="images/dropdown.svg" class="inline-icon" id="magnifying-glass-icon" aria-hidden="true" alt="">
                            <span id="current-page-lang"></span>
                        </button>
                        <div id="page-lang-dropdown" class="dropdown-content">
                            <div class="search-wrapper rounded-top">
                                <img src="images/dropdown.svg" class="inline-icon" aria-hidden="true" alt="">
                                <input id="page-lang-text" class="search-input" type="text" placeholder=""
                                    aria-label="Page Language"
                                    onkeyup="filterPageLangs()">
                            </div>
                            <div id="page-lang-options" class="dropdown-options"></div>
                            <a id="add-translation-link" target="_blank" rel="noreferrer noopener"
                            href="https://github.com/alt-text-org/ocrop/issues/new?&template=translation.md&title=%5BTranslation%5D+Language"></a>
                        </div>
                    </div>
                </div>
                <div id="right-ctl">
                    <button id="extract-btn" onclick="extract()" disabled></button>
                </div>
            </div>
            <div id="cvs-wrapper">
                <div id="upload-wrapper">
                    <div class="upload-area">
                        <input type="file" id="upload" accept="image/*"/>
                    </div>
                    <label id="upload-label"></label>
                </div>
                <canvas id="cvs" width="1" height="1"></canvas>
                <p id="explanation"></p>
            </div>
            <div id="links">
                <a href="https://social.alt-text.org/@hannah"><img class="link-logo" src="images/masto.svg" alt="Mastodon"></a>
                <a href="https://alt-text.org"><img class="link-logo" src="images/alt-text-org.svg" alt="Alt-Text.org"></a>
                <a href="https://github.com/alt-text-org/ocrop"><img class="link-logo" src="images/github.svg" alt="GitHub"></a>
            </div>
        </div>
        <div id="right-col">
            <div id="result-wrapper">
                <div id="filter-wrapper" class="search-wrapper">
                    <img src="images/magnifying.svg" class="inline-icon" alt="" aria-hidden="true">
                    <input id="filter-input" class="search-input" type="text" placeholder="#" aria-label="Alt Text Search">
                </div>
                <div id="descriptions"></div>
                <div id="import-export">
                    <button id="import-btn" onclick="exportDescriptions()"></button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>